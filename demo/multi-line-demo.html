<dom-module id="multi-line-demo">
  <template>
    <style include="vaadin-component-demo-shared-styles">
      :host {
      display: block;
    }
    #control {
      color: red;
    }
    </style>
    <h3>Line Chart Demo</h3>
    <p>This demo shows three ways to display a line chart, starting with the easiest and more straightforward. </p>
    <p>First way: use <code>multi-chart-line</code> and pass data to the chart. Data series are being constructed via the <code>multi-serie</code> element</p>
    <vaadin-demo-snippet id='multi-chart-line-demo-binding'>
      <template preserve-content>
        <dom-bind id="app-line">
          <template>
            <style>:host {display: flex;} #chart {flex: 2;}#control {flex: 1;  padding: 15px;}</style>
            <!-- display the chart  -->
            <multi-chart-line 
                id="chart"  
                color-scale="[[colorScale]]"
                bottom-accessor-path="key"
                data="[[data]]"
                left-tick-format="[[leftTickFormat]]">
              <dom-repeat items="{{keys}}">
                <template>
                 <!-- we need a accessor for y-scale -->
                 <multi-accessor accessor="{{item.accessor}}" path="+value.[[item.key]]"></multi-accessor>
                 <!-- set the series inthe markup. We can also pass a series object directly to the  -->
                 <multi-serie key="[[item.key]]" label="[[item.label]]" accessor="{{item.accessor}}"></multi-serie>
                </template>
              </dom-repeat>
            </multi-chart-line>
            <div id="control">
              <paper-input raised value="{{domainMax}}" type="number" placeholder="set max value" min="10" max="100" label="left axis max" ></paper-input>
              <paper-button raised on-tap="toggle">toggle data</paper-button>
            </div>
          </template>
        </dom-bind>
      </template>
    </vaadin-demo-snippet>
    <script>
    window.addDemoReadyListener('#multi-chart-line-demo-binding', function(document) {

      app3 = document.querySelector('#app-line');
      chart3 = app3.$.chart;
      app3.keys = [{key: 'ananas'}, {key: 'banana'}, {key: 'apple'}, {key: 'orange'}];
      const d1 = MultiChart.LineDemo.multipleRnd(app3.keys.map(k => k.key), 50);
      const d2 = MultiChart.LineDemo.multipleRnd(app3.keys.map(k => k.key), 50);

      let isD1 = false;

      app3.colorScale = d3.scaleOrdinal().range(d3.schemeCategory10);
      chart3.transition = function(transition) {
        return transition.duration(400);
      };
      app3.valuePath = '+ananas';
      app3.data = d1;

      app3.toggle = function() {
        isD1 = !isD1;
        app3.data = isD1 ? d2 : d1;
      };

    });
    </script>

    <p>Second way: stamp a <code>multi-drawable-line</code> within <code>multi-container-axis</code>.</p>
    <vaadin-demo-snippet id='multi-line-serie-demo-binding'>
      <template preserve-content>
        <dom-bind id="app-serie">
          <template>
            <style>:host {display: flex;} #chart {flex: 2;}#control {flex: 1;  padding: 15px;}</style>
            <multi-container-axis 
                id="chart"  
                top-axis="[[topAxis]]"
                left-axis="[[leftAxis]]"
                bottom-axis="[[bottomAxis]]"
                right-axis="[[rightAxis]]"
                bottom-scale-type="scalePoint"
                serie-value-domain="{{serieValueDomain}}"
                serie-ordinal-domain="{{serieOrdinalDomain}}"
                left-accessor-path="[[valuePath]]"
                left-domain-max="[[domainMax]]"
                data="[[data]]"
                scales="{{scales}}"
                accessors="{{accessors}}"
                left-tick-format="[[leftTickFormat]]">
              <dom-repeat items="{{keys}}">
                <template>
                 <!-- we need a accessor for y-scale -->
                 <multi-accessor accessor="{{item.accessor}}" path="+value.[[item.key]]"></multi-accessor>
                 <multi-serie key="[[item.key]]" label="[[item.label]]" accessor="{{item.accessor}}"></multi-serie>
                </template>
              </dom-repeat>
              <multi-drawable-line 
                  color-scale="[[colorScale]]"
                  x-scale="[[scales.bottom]]" 
                  y-scale="[[scales.left]]" 
                 ></multi-drawable-line>
            </multi-container-axis>
            <div id="control">
              <paper-input raised value="{{domainMax}}" type="number" placeholder="set max value" min="10" max="100" label="left axis max" ></paper-input>
              <paper-button raised on-tap="toggle">toggle data</paper-button>
            </div>
          </template>
        </dom-bind>
      </template>
    </vaadin-demo-snippet>
    <script>
    window.addDemoReadyListener('#multi-line-serie-demo-binding', function(document) {

      app2 = document.querySelector('#app-serie');
      chart2 = app2.$.chart;
      app2.keys = [{key: 'ananas'}, {key: 'banana'}, {key: 'apple'}, {key: 'orange'}];
      const d1 = MultiChart.LineDemo.multipleRnd(app2.keys.map(k => k.key), 50);
      const d2 = MultiChart.LineDemo.multipleRnd(app2.keys.map(k => k.key), 50);

      let isD1 = false;

      app2.colorScale = d3.scaleOrdinal().range(d3.schemeCategory10);
      chart2.transition = function(transition) {
        return transition.duration(400);
      };

      app2.domainMax = 50;
      app2.bottomAxis = true;
      app2.leftAxis = true;
      app2.data = d1;

      app2.toggle = function() {
        isD1 = !isD1;
        app2.data = isD1 ? d2 : d1;
      };

    });
    </script>

    <p>Third way: use a <code>dom-repeat</code> with <code>multi-drawable-line-path</code> drawing individual lines.</p>
    
    <vaadin-demo-snippet id='multi-line-demo-binding'>
      <template preserve-content>
        <dom-bind id="app">
          <template>
            <style>:host {display: flex;} #chart {flex: 2;}#control {flex: 1;  padding: 15px;}</style>
            <multi-container-axis 
                id="chart"  
                left-axis
                bottom-axis
                bottom-scale-type="scalePoint"
                bottom-accessor-path="[[keyPath]]"
                left-accessor-path="[[valuePath]]"
                left-domain-min="0"
                left-domain-max="[[domainMax]]"
                left-elastic
                data="[[data]]"
                scales="{{scales}}"
                accessors="{{accessors}}"
                left-tick-format="[[leftTickFormat]]">
              <dom-repeat items="{{keys}}">
                <template>
                 <!-- we need a accessor for y-scale -->
                  <multi-accessor accessor="{{item.accessor}}" path="+value.[[item.key]]"></multi-accessor>
                  <multi-drawable-line-path 
                    key="[[item.key]]"
                    color-scale="[[colorScale]]"
                    x-scale="[[scales.bottom]]" 
                    x-accessor="[[accessors.bottom]]" 
                    y-scale="[[scales.left]]" 
                    y-accessor="[[item.accessor]]"></multi-drawable-line-path>
                </template>
              </dom-repeat>
            </multi-container-axis>
            <div id="control">
              <paper-input raised value="{{domainMax}}" type="number" placeholder="set max value" min="10" max="100" label="left axis max" ></paper-input>
              <paper-button raised on-tap="toggle">toggle data</paper-button>
            </div>
          </template>
        </dom-bind>
      </template>
    </vaadin-demo-snippet>
    <script>
      
    window.addDemoReadyListener('#multi-line-demo-binding', function(document) {

      app = document.querySelector('#app');
      chart = app.$.chart;
      // const keys = ['a', 'b', 'c', 'd', 'e', 'f'];
      app.keys = [{key: 'ananas'}, {key: 'banana'}, {key: 'apple'}, {key: 'orange'}];
      const d1 = MultiChart.LineDemo.multipleRnd(app.keys.map(k => k.key), 50);
      const d2 = MultiChart.LineDemo.multipleRnd(app.keys.map(k => k.key), 50);

      let isD1 = false;

      app.colorScale = d3.scaleOrdinal().range(d3.schemeCategory10);
      chart.transition = function(transition) {
        return transition.duration(400);
      };

      app.keyPath = 'key';
      app.valuePath = '+value.ananas';
      
      app.data = d1;

      app.toggle = function() {
        isD1 = !isD1;
        app.data = isD1 ? d2 : d1;
      };

    });
    
    </script>
    


  </template>
  <script>
  (function() {

    class LineDemo extends DemoReadyEventEmitter(MultiChart.Demo(Polymer.Element)) {
      static get is() {
        return 'multi-line-demo';
      }
    }
    customElements.define(LineDemo.is, LineDemo);

    if (!window.MultiChart) {
      window.MultiChart = {};
    }
    window.MultiChart.LineDemo = LineDemo;

  })();
  </script>
</dom-module>