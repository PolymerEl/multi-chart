<dom-module id="multi-pie-demo">
  <template>
    <style include="vaadin-component-demo-shared-styles">
      :host {
      display: block;
    }
    #control {
      color: red;
    }
    </style>
    <h3>Pie Chart Demo</h3>
    <p>Example of a simple pie chart.</p>
    <vaadin-demo-snippet id='multi-pie-demo-binding'>
      <template preserve-content>
        <dom-bind id="app">
          <template>
            <style>:host {display: flex;} #chart {flex: 2;}#control {flex: 1;  padding: 15px;}</style>
            <!-- display pie chart -->
            <multi-chart-pie 
              id="chart" 
              value-path="[[valuePath]]" 
              inner-radius="[[innerRadius]]" 
              pad-angle="[[padAngle]]" 
              color-scale="[[colorScale]]"
              data="[[data]]">
              <!-- add a legend -->
              <multi-legend scale="[[colorScale]]" position="top-right"></multi-legend>
              <!-- make it selectable -->
              <multi-select selected="{{selected}}" track-hover></multi-select>
              <h2 slot="header">[[title]]</h2>
              <code slot="footer">selected: [[selected]]</code>
            </multi-chart-pie>
            <div id="control">
              <paper-input raised value="{{title}}" label="title"></paper-input>
              <paper-input raised value="{{innerRadius}}" type="number" label="inner radius" min="0"></paper-input>
              <paper-input raised value="{{padAngle}}" type="number" step=".01" label="pad angle" min="0" max="0.3"></paper-input>
              <paper-button raised on-tap="toggle">toggle data</paper-button>
            </div>
          </template>
        </dom-bind>
      </template>
    </vaadin-demo-snippet>
    <script>
    window.addDemoReadyListener('#multi-pie-demo-binding', function(document) {

       app = document.querySelector('#app');
      const keys = ['a', 'b', 'c', 'd', 'e', 'f'];

      //e.g. d1 = [{"key":"a","value":{"count":1.7}},{"key":"b","value":{"count":24.3}},{"key":"c","value":{"count":1.38}},{"key":"d","value":{"count":3.2}},{"key":"e","value":{"count":1.76}},{"key":"f","value":{"count":35.365612695230766}}]
      const d1 = MultiChart.PieDemo.rnd(keys, 50);
      const d2 = MultiChart.PieDemo.rnd(keys, 50);

      let isD1 = false;
      chart = app.$.chart;

      app.colorScale = d3.scaleOrdinal().range(d3.schemeCategory10).domain(keys);
      chart.transition = function(transition) {
        return transition.duration(400);
      };

      app.keyPath = 'key';
      app.title = 'Pie Chart';
      app.valuePath = '+value.count';
      app.innerRadius = 45;
      app.padAngle = 0.02;
      app.data = d1;

      app.toggle = function() {
        isD1 = !isD1;
        app.data = isD1 ? d2 : d1;
      };

    });
    </script>
  </template>
  <script>
  (function() {

    class PieDemo extends DemoReadyEventEmitter(MultiChart.Demo(Polymer.Element)) {
      static get is() {
        return 'multi-pie-demo';
      }
    }
    customElements.define(PieDemo.is, PieDemo);

    if (!window.MultiChart) {
      window.MultiChart = {};
    }
    window.MultiChart.PieDemo = PieDemo;

  })();
  </script>
</dom-module>