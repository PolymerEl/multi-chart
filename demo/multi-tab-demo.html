<dom-module id="multi-tab-demo">
  <template>
    <style include="vaadin-component-demo-shared-styles">
      :host {
      display: block;
    }
    #control {
      color: red;
    }
    </style>
    <h3>Bar Tab Demo</h3>
    <vaadin-demo-snippet id='multi-tab-serie-demo-binding'>
      <template preserve-content>
        <dom-bind id="app">
          <template>
            <style>:host {display: flex;} #chart {flex: 2;}#control {flex: 1;  padding: 15px;}</style>
            <paper-tabs selected="{{selected}}" attr-for-selected="name">
              <paper-tab name="one">ITEM ONE</paper-tab>
              <paper-tab name="two">ITEM TWO</paper-tab>
            </paper-tabs>
            <iron-pages selected="[[selected]]" attr-for-selected="name">
              <div name="one">
                <h3>one</h3>
                <multi-container-axis 
                    id="chart"  
                    data-stack
                    margin="[[margin]]"
                    bottom-axis
                    left-elastic="[[elastic]]"
                    left-axis
                    bottom-scale-type="scaleBand"
                    bottom-padding="[[padding]]"
                    left-ticks='[5,"s"]'
                    data="[[data]]"
                    ordinal-domain-mapper="[[statesMapper]]"
                    scales="{{scales}}" >
                  <dom-repeat items="{{keys}}">
                    <template>
                      <multi-serie key="[[item]]" key-path="State" label="[[item]]"></multi-serie>
                    </template>
                  </dom-repeat>
                  <multi-drawable-bar 
                      select-serie
                      keys="[[keys]]"
                      color-scale="[[colorScale]]"
                      x-scale="[[scales.bottom]]" 
                      y-scale="[[scales.left]]"
                      stacked="[[stacked]]"
                     ></multi-drawable-bar>
                  <multi-legend scale="[[colorScale]]" labels="[[keys]]" position="top-right"></multi-legend>
                </multi-container-axis>
                <div id="control">
                  <paper-checkbox checked="{{stacked}}">stacked</paper-checkbox>
                  <paper-checkbox checked="{{elastic}}">elastic axis</paper-checkbox>
                  <paper-input raised value="{{padding}}" type="number" placeholder="padding" min="0" max="0.9" step="0.1" label="bottom axis padding" ></paper-input>
                  <paper-input raised value="{{margin.right}}" type="number" placeholder="right margin" min="0" max="200" step="5" label="right margin" ></paper-input>
                </div>
              </div>
              <div name="two">
                <h3>two</h3>
              </div>
            </iron-pages>
          </template>
        </dom-bind>
      </template>
    </vaadin-demo-snippet>
    <script>
    window.addDemoReadyListener('#multi-tab-serie-demo-binding', function(document) {

      app = document.querySelector('#app');
      chart = app.$.chart;

      d3.csv('census.csv')
      .then(data => {

        console.info('DATA', data, app.keys);

        app.keys = data.columns.slice(1);
        const states = data.map(function(d) { return d.State; })
        app.statesMapper = (d,i) => states[i];
        app.padding = 0.1;
        app.stacked = true;

        app.margin = {
              top: 20,
              right: 130,
              bottom: 20,
              left: 30
            };

        app.colorScale = d3.scaleOrdinal().range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);
        app.data = data;

    });

    });
    </script>
  </template>
  <script>
  (function() {

    class TabDemo extends DemoReadyEventEmitter(MultiChart.Demo(Polymer.Element)) {
      static get is() {
        return 'multi-tab-demo';
      }
    }
    customElements.define(TabDemo.is, TabDemo);

    if (!window.MultiChart) {
      window.MultiChart = {};
    }
    window.MultiChart.TabDemo = TabDemo;

  })();
  </script>
</dom-module>