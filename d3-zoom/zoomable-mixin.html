<link rel="import" href="../helper/config-helper-mixin.html">
<link rel="import" href="zoomable-property-mixin.html">
<script>
(function() {

  /**
   * ##  Zoomable
   * 
   * allows charts to be zoomable
   * 
   * @memberof MultiChart.mixin
   * @polymer
   * @mixinFunction
   */
  const Zoomable = superClass => {
	
		return class extends 
			MultiChart.mixin.ConfigHelper(
				MultiChart.mixin.ZoomableProperty(
					superClass)) {

      static get properties() {
        return {
          /* 
           * `enableZoom` set true to enable zoom behaviors
           */
          enableZoom: {
            type: Boolean,
            reflectToAttribute: true,
            observer: '_observeEnableZoom'
          },

         
        };
      }

      static get observers() {
        return [
          'observeConfig(extent.*, "extent", "_zoom")',
          'observeConfig(scaleExtent.*, "scaleExtent", "_zoom")',
        ];
      }

      get zoomedEl() {
        return d3.select(this.$['slot-zoom']);
      }

      _observeEnableZoom(enable, old) {
        if (enable) {
          const zoomed = () => {
            this.zoomedEl.attr('transform', d3.event.transform);
          };

          this._zoom = d3.zoom().on('zoom', zoomed);
          d3.select(this.$.svg).call(this._zoom);
          
        }
        if (!enable && old) {
        	this._zoom = null;
        }

      }
    };
  };

  if (!window.MultiChart) {
    window.MultiChart = {};
  }

  /* 
   * @namespace MultiChart.mixin
   */
  window.MultiChart.mixin = window.MultiChart.mixin || {};
  /* 
   * @mixinFunction
   */
  window.MultiChart.mixin.Zoomable = Zoomable;

})();
</script>