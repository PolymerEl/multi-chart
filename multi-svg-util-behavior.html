<link rel="import" href="../polymer/polymer.html">
<script>
/**
 * `multiSvgUtil` utility methods for manipulating svg transform attribute
 *
 */

'use strict';

window.multi = window.multi || {}; 

/** @polymerBehavior multi.svgUtil*/
multi.svgUtil = {

  translateCenter: function(w, h) {
    return 'translate(' + w / 2 + ',' + h / 2 + ')';
  },

  translate: function(x, y) {
    return 'translate(' + x + ',' + y + ')';
  },
  rotate: function(angle) {
    return 'rotate(' + angle + ')';
  },
  svgScale: function(factor) {
    return 'scale(' + factor + ')';
  },
  //TODO
  matrix: function() {
    return 'matrix(' + ',' + ')';
  },

  fitTo: function(source, target, factor) {
      //reset the transform attribute
      factor = factor  || 0.95;
      d3.select(source).attr("transform", null);

      var sourceRect = source.getBoundingClientRect(),
          targetRect = target.getBoundingClientRect(),
      dx = sourceRect.width,
      dy = sourceRect.height,
      x = (-sourceRect.left + sourceRect.right) / 2,
      y = (-sourceRect.top + sourceRect.bottom) / 2, 
      scale = factor / Math.max(dx / targetRect.width, dy / targetRect.height),
      translate = [targetRect.width / 2 - scale * x, targetRect.height / 2 - scale * y];

      d3.select(source).attr('transform', 'translate(' + translate[0]  + ',' + translate[1] + ') scale(' + scale + ')');
  }

};
</script>
