<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<script>
(function() {
  'use strict';

  var B = window.multi = window.multi || {};

  var resizer = {

    properties: {
      chartHeight: {
        type: Number,
        readOnly: true,
        value: 0
      },

      chartWidth: {
        type: Number,
        readOnly: true,
        value: 0
      },

      margin: {
        type: Object,
        value: function() {
          return {
            top: 20,
            left: 40,
            right: 20,
            bottom: 20
          };
        }
      }
      // extent: {
      //   type: Array,
      //   computed: '__computeExtent(chartHeight, chartWidth)'
      // }
    },

    listeners: {
      'iron-resize': '__onIronResize'
    },

    observers: [
      'observeMargin(margin.*)'
    ],

    attached: function() {
      this.calculateSize();
      // this.async(this.notifyResize, 1);
    },

    observeMargin: function(margin) {
      this.calculateSize(margin.base);
    },

    calculateSize: function() {

      this.debounce(this, function() {
        var rect = this.$.svg.getBoundingClientRect();
        // console.info('Rect', rect);
        this._setChartWidth(Math.floor(rect.width) - this.margin.top - this.margin.bottom);
        this._setChartHeight(Math.floor(rect.height) - this.margin.left - this.margin.right);
        this.fire('multi-resize');
      }, 10);
    },

    // get parent() {
    //   if (this.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
    //     return this.parentNode.host;
    //   }

    //   return this.parentNode;
    // },

    __onIronResize: function() {
      this.calculateSize()
    },

  };

  B.resizer = [
    Polymer.IronResizableBehavior,
    resizer
  ]

})();
</script>
